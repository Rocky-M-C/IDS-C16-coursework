library(tidyverse)
library(dplyr)
#Reading the CSV file 
gdp_countries <- read_csv("gdp-per-capita-worldbank.csv") %>% clean_names()
head(gdp_countries)
#Clean country names (trim/normalize whitespace)
gdp <- gdp %>%
  mutate(country = str_squish(as.character(country))) %>%
  filter(!is.na(country) & country != "")
#pivot year columns (wide -> long)
pivot_years_if_needed <- function(df, value_name = "gdp_per_capita") {year_cols <- names(df)[str_detect(names(df), "^\\d{4}$")]
  if (length(year_cols) > 0) {
    df_long <- df %>%
      pivot_longer(cols = all_of(year_cols), names_to = "year", values_to = value_name) %>%
      mutate(year = as.integer(year),)
    return(df_long)
  } else {
    # no year-like columns found; return df as-is
    return(df)
  }
}
#Apply pivoting
gdp_long <- pivot_years_if_needed(gdp, value_name = "gdp_per_capita")
#Convert gdp_per_capita to numeric
if ("gdp_per_capita" %in% names(gdp_clean)) {gdp_clean <- gdp_clean %>%mutate(gdp_per_capita = as.numeric(gdp_per_capita))}
#Create a tidy list of countries (unique, sorted)
gdp_countries <- gdp_clean %>%
  distinct(country) %>%
  arrange(country)

#Population, Read the raw CSV file uploaded
pop <- read_csv("population.csv")
#Rename first column to "country"
names(pop)[1] <- "country"
#Clean country names
pop <- pop %>% 
  mutate(country = str_trim(country)) %>%
  filter(country != "", !is.na(country))
#Convert from wide to long format
pop_long <- pop %>%
  pivot_longer(cols = -country, names_to = "year", values_to = "population")
#Convert to numbers and remove missing values
pop_clean <- pop_long %>%
  mutate(year = as.numeric(year), population = as.numeric(population)) %>% filter(!is.na(year), !is.na(population)) %>% arrange(country, year)
#Show results
head(pop_clean, 12)
print(paste("Total rows:", nrow(pop_clean)))
print(paste("Countries:", n_distinct(pop_clean$country)))


