library(tidyverse)

# GDP per capita, reading the CSV file 
gdp <- read_csv("gdp-per-capita-worldbank.csv")  # Changed 'dp' to 'gdp'

# Rename first column to "country"
names(gdp)[1] <- "country"

# Clean country names
gdp <- gdp %>% 
  mutate(country = str_trim(country)) %>% 
  filter(country != "", !is.na(country))

# Convert year columns to numbers and remove missing values
gdp_clean <- gdp %>%
  mutate(across(-country, as.numeric)) %>%
  filter(country != "", !is.na(country))

# Show results
head(gdp_clean)
print(paste("Total rows:", nrow(gdp_clean)))

# Population, Read the raw CSV file uploaded
pop <- read_csv("population.csv")

# Rename first column to "country"
names(pop)[1] <- "country"

# Clean country names
pop <- pop %>% 
  mutate(country = str_trim(country)) %>%
  filter(country != "", !is.na(country))

# Convert year columns to numbers and remove missing values
pop_clean <- pop %>%
  mutate(across(-country, as.numeric)) %>%
  filter(country != "", !is.na(country))

# Show results
head(pop_clean, 12)
print(paste("Total rows:", nrow(pop_clean)))
print(paste("Countries:", n_distinct(pop_clean$country)))
